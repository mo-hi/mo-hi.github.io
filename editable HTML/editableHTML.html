<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Mo Hi">
    <title>EDITABLE HTML</title>
    <link rel="stylesheet" href="../basis/css/b.css"></style>
    <style>
        :root       {--color-background: #f0f0f0;--color-text: #444;}
        body        {background-color: var(--color-background); color: var(--color-text);}
        h2.sticky   {background-color: var(--color-background); color: var(--color-text);}
        textarea    {background-color: var(--color-background); color: var(--color-text);}
    </style>
</head>
<body class="academic wr-800-400">
    <h1>EDITABLE HTML</h1>
    <section>
    <p class="fontPlus2">
        Editable HTML provides a way to make divs of your HTML content editable. 
        The behavior of Editable HTML is very similar to the <c>contentEditable = true</c> feature supported by most browsers.
        Editable HTML wil create a textareas inside your divs and the textarea value will get the divs innerHTML.
        By that you can also modify the html inside a div.
    </p>
    <p class="fontPlus2">
        The user interface of Editable HTML is either be based on mouse clicks and keyboard events of based on buttons.
        Let's go through the different options.
    </section>


    <section>
       
        <h2 class="underline sticky">Editable div via mouse click and keyboard event</h2>
        <p class="mt-0i">
            Below are two divs with a border. Each div can be edited by clicking inside the divs area. 
            The first div is implemented using the build-in browser/html feature <c>contentEditable</c>.
            The second div is implemented using Editable HTML of this project. Try it and experience the different behavior
        </p>

        <div contenteditable="true" class="w-600px border h-30 p-2">
            This can be edited using a <b>build-in</b> html feature (for reference)
        </div>
        <br>

        <div id="root-01">
            <div id="id-01" class="mb-20i">
                <div class="w-600px border h-30 p-2 js-edit js-event">
                    This can be edited using the <b>Editable HTML</b> of this project
                </div>
            </div>
        </div>

        <p> 
            Notice the different behavior of the two divs
        </p>
        <p class="w-90 pl-40">
            (1) In EditableHTML you have to press 'Ctrl' key and click inside the div to make it editable.
            This shall avoid unintentional changes to edit mode.
        </p>
        <p class="w-90 pl-40">
            (2) Editable HTML will set the divs innerHTML back to its original value, when click outside the div to avoid unintential changes.
            The buld-in feature will save your input and the original value gets lost.  
        </p>
        <p class="w-90 pl-40">
            (3) In this example, Editable HTML will only save your input when you press 'Ctrl + Enter' or 'Ctrl + Blankspace'. 
            Each input must be confirmed by a dedicated user action, that makes it unlikey to happen by mistake.
        </p>




        <b>HTML</b>
        <p class="mt-0i">
            I your html you need to add the class <c>js-edit</c> to the div you want to be editable. The class <c>js-event</c> is also needed 
            as this element will get eventlisteners.
        </p>
        <div id="show-01" class="h-90 mb-20i"></div>
        <b>JS</b>
        <p class="mt-0i">
        In your script section, you need to call the function <c>editableHTML_Init()</c> and pass the id of the node div container
        that has the editable divs. In this first example, there is only one editable div inside the node container.
        <p>
        <div id="show-js-01" class="h-140"></div>
        <!-- --------------------------------------------------------------------------------------- -->

        <!-- <h2 class="underline sticky">02 More text divs</h2>
        <b>APPLICATION</b> -->
        <br>
        <p>
            Here's the example with three multiple editable divs inside the node container,  containing the class <c>js-edit</c> and <c>js-event</c> 
        </p>
        <div id="root-02">
            <div id="id-02">
                <div class="w-200px border inline-block h-30 p-2 js-edit js-event">
                    This is div 1
                </div>
                <div class="w-200px border inline-block h-30 p-2 js-edit js-event">
                    This is div 2
                </div>
                <div class="w-200px border inline-block h-30 p-2 js-edit js-event">
                    This is div 3
                </div>
            </div>
        </div>
        <br>
        <b>HTML</b>
        <div id="show-02" class="h-180"></div>
        <br>
        <b>JS</b>
        <div id="show-js-02" class="h-140"></div>
        <!-- --------------------------------------------------------------------------------------- -->

        <h2 class="underline sticky"> Multi Editable divs via mouse click and keyboard event</h2>
        <p class="mt-0i">
            In this variant, the three text divs are connected. They form one logical edit unit, which are saved or discarded together.
            The editable divs need to be children of <c>js-edit</c> and have the class <c>js-edit-child</c>. 
            Note that clicking outside the textare here will not undo your edit. Here we have to use the keyboard event 'esc' to discard the changes.
        </p>
        <div id="root-02b">
            <div id="id-02b">
                <div class="js-edit">
                    <div class="w-200px border inline-block h-30 p-2 js-edit-child js-event">
                        This is div 1
                    </div>
                    <div class="w-200px border inline-block h-30 p-2 js-edit-child js-event">
                        This is div 2
                    </div>
                    <div class="w-200px border inline-block h-30 p-2 js-edit-child js-event">
                        This is div 3
                    </div>
                </div>
            </div>
        </div>
        <br>
        <b>HTML</b>
        <div id="show-02b" class="h-220"></div>
        <br>
        <b>JS</b>
        <div id="show-js-02b" class="h-140"></div>
        <!-- --------------------------------------------------------------------------------------- -->

        <h2 class="underline sticky">Editable div with buttons</h2>
        <p>
            In this example the user interface is based on buttons. Mouse clicks on the editable div and keyboard events are disabled here.
            The class <c>js-event</c> therefore has to move from the editiable div to the buttons. There a three buttons, edit, save and discard.
            The buttons can be located anywhere on the html as children of a div with class <c>js-edit-btn</c>. 
            The link between the <c>js-edit</c> and <c>js-edit-btn</c> element is done via <c>data-editable-link</c> attribute which must be the same value.
        </p>
        <p>
            To minimize html code, the buttons edit and save are by befault identified as the first and second child of the <c>js-edit-btn</c> element.
            When <c> js-edit-btn</c> has a third child, like in this exmaple, then the third child is identified as discard button. 
            The discard button also can a separate element anywhere on the page. In yout html you have to set the class <c>hidden</c> to the save and discard button.
        </p>

        <div id ="root-03">
            <div class="inline-block js-edit-btn" data-editable-link="link-03"> 
                <div class="btn blue js-event">{{svg-icon-edit-18}}</div>
                <div class="btn blue js-event hidden">{{svg-icon-save-18}}</div>
                <div class="btn blue js-event hidden">{{svg-icon-discard-12}}</div>
            </div> 
            <div id="id-03" class="inline-block">
                <div class="w-300px border h-30 p-2 js-edit" data-editable-link="link-03">
                    This is a div 1
                </div>
            </div>
        </div>

        <br>
        HTML:
        <div id="show-03" class="h-160"></div>
        <br>
        JS:
        <div id="show-js-03" class="h-140"></div>
        <br>
        <p>
            In this example the discard button is a seperate element. To link the discard button with its corresponding editable div, and button container
            the data <c>data-editable-link</c> with the same value must be added.
        </p>
        <p>
            So either the class <c>js-edit-btn</c> has a third child, which is the discard button, or the data-value pair of <c>data-editable-link</c> occurs three times 
            on the page (for a particular value), where only one has also the class <c>js-event</c>, which is the discard button.
        </p>
        <div id ="root-04">
            <div class="inline-block js-edit-btn" data-editable-link="link-04"> 
                <div class="btn blue js-event">{{svg-icon-edit-18}}</div>
                <div class="btn blue js-event hidden">{{svg-icon-save-18}}</div>
            </div> 
            <div id="id-04" class="inline-block">
                 <div class="w-300px border inline-block h-30 p-2 js-edit" data-editable-link="link-04">
                    This is a div 1
                </div>
            </div>
            <div class="btn blue js-event hidden" data-editable-link="link-04">{{svg-icon-discard-12}}</div>
        </div>
        <br>
        HTML:
        <div id="show-04" class="h-180"></div>
        <br>
        JS:
        <div id="show-js-04" class="h-120"></div>
        <!-- --------------------------------------------------------------------------------------- -->
        <h2 class="underline sticky">05 discard button seperated with multiple divs</h2>
        <p>
            Same logic as above. You can have multiple editable divs can be placed inside a node container. The button actions applay to all divs inside the node
        </p>

        <div id ="root-05">
            <div class="inline-block js-edit-btn" data-editable-link="link-05"> 
                <div class="btn blue js-event">{{svg-icon-edit-18}}</div>
                <div class="btn blue js-event hidden">{{svg-icon-save-18}}</div>
            </div> 

            <div id="id-05"  class="inline-block">
                <div class="js-edit" data-editable-link="link-05">
                    <div class="w-200px border inline-block h-30 p-2 js-edit-child">
                        This is a div 1
                    </div>
                    <div class="w-200px border inline-block h-30 p-2 js-edit-child">
                        This is a div 2
                    </div>
                    <div class="w-200px border inline-block h-30 p-2 js-edit-child">
                        This is a div 3
                    </div>
                </div>
            </div>

            <div class="btn blue js-event hidden" data-editable-link="link-05">
                {{svg-icon-discard-12}}
            </div>
        </div>
        <br>
        HTML:
        <div id="show-05" class="h-320"></div>
        <br>
        JS:
        <div id="show-js-05" class="h-140"></div>
        <!-- --------------------------------------------------------------------------------------- -->
                <h2 class="underline sticky">Example 6: table</h2>
                <p>
                    .... 
                </p>
                <div  id="root-06">
                    <table id="id-06" class="border border-cells padding-5 w-600px">
                        <tbody>
                            <tr id="id-node-table" class="js-edit w-15" data-editable-link="link-06">
                                <td >
                                    <div class="inline-block js-edit-btn" data-editable-link="link-06"> 
                                        <div class="btn blue js-event">{{svg-icon-edit-18}}</div>
                                        <div class="btn blue js-event hidden">{{svg-icon-save-18}}</div>
                                        <div class="btn blue js-event hidden">{{svg-icon-discard-12}}</div>
                                    </div> 
                                </td>
                                <td class="js-edit-child w-20">
                                    some text
                                </td>
                                <td class="js-edit-child w-20">
                                    some other text
                                </td>
                                <td class="js-edit-child w-20">
                                    some other text
                                </td>
                                <td class="js-edit-child w-25">
                                    some other text
                                </td>
                            </tr>
                            <tr id="id-node-table" class="js-edit w-15" data-editable-link="link-06b">
                                <td >
                                    <div class="inline-block js-edit-btn" data-editable-link="link-06b"> 
                                        <div class="btn blue js-event">{{svg-icon-edit-18}}</div>
                                        <div class="btn blue js-event hidden">{{svg-icon-save-18}}</div>
                                        <div class="btn blue js-event hidden">{{svg-icon-discard-12}}</div>
                                    </div> 
                                </td>
                                <td class="js-edit-child w-20">
                                    some text
                                </td>
                                <td class="js-edit-child w-20">
                                    some other text
                                </td>
                                <td class="js-edit-child w-20">
                                    some other text
                                </td>
                                <td class="js-edit-child w-25">
                                    some other text
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <br>
                <br>
                HTML:
                <div id="show-06" class="h-400"></div>
                <br>
                JS:
                <div id="show-js-06" class="h-140"></div>

       
    <section>
        <p id="id-end" class="auto-fill">
            {{id-end-index}}
        </p>
    </section>

</body>

<script src="../basis/js/b.js"></script>
<script src="../textGeneral.js"></script>
<script src="js/editableHTML.js"></script>  <!-- this project -->

<script>
    // auto generation
    for (let id of ["01", "02","02b","03", "04", "05", "06"]) {
        ShowHTMLinTextArea(document.getElementById("root-" + id), document.getElementById("show-" + id))}

    Auto_Fill(FromFile_textGeneral_js,"id-end")
        
    for (let id of ["id-01", "id-02", "root-03", "root-04", "root-05", "id-06"]) {
        Auto_Fill(b_svg([12,18,24]),id)} 
</script>
<script id = "id-js-01">
    // let EDIT = new functions_editableHTML()
    // EDIT.Init('id-01') 

    new functions_editableHTML().Init('id-01');

</script>
<script id = "id-js-02">
    let EDIT = new functions_editableHTML()
    EDIT.Init('id-02')
    // validate:
    let divs2 = document.getElementById('id-02').DescendantsWithClass('.js-edit')
    // for (let div of divs2) {
    //     EditGroup = new cls_editableHTML_EditGroup(div)
    //     assert (EditGroup.IsSingleTextDiv())}
</script>
<script id = "id-js-02b">
    EDIT.Init('id-02b')
    // validate:
//     let div2b = document.getElementById('id-02b').DescendantsWithClass('.js-edit')[0]
//     EditGroup = new cls_editableHTML_EditGroup(div2b)
//     assert (EditGroup.IsMultiTextDiv())
// </script>
<script id = "id-js-03">
    EDIT.Init('id-03')
    // validate:
    // div = document.getElementById('id-03').DescendantsWithClass('.js-edit')[0]
    // EditGroup = new cls_editableHTML_EditGroup(div)
    // assert (EditGroup.IsSingleTextDiv())
    // assert (EditGroup.HasButtons())
</script>
<script id = "id-js-04">
    EDIT.Init('id-04')
    // validate:
    // div = document.getElementById('id-04').DescendantsWithClass('.js-edit')[0]
    // EditGroup = new cls_editableHTML_EditGroup(div)
    // assert (EditGroup.IsSingleTextDiv())
    // assert (EditGroup.HasButtons())
</script>
<script id = "id-js-05">
    EDIT.Init('id-05')
    // validate:
    // div = document.getElementById('id-05').DescendantsWithClass('.js-edit')[0]
    // EditGroup = new cls_editableHTML_EditGroup(div)
    // assert (EditGroup.IsMultiTextDiv())
    // assert (EditGroup.HasButtons())
</script>
<script id = "id-js-06">
    EDIT.Init('id-06')
    // validate:
    // div = document.getElementById('id-05').DescendantsWithClass('.js-edit')[0]
    // EditGroup = new cls_editableHTML_EditGroup(div)
    // assert (EditGroup.IsMultiTextDiv())
    // assert (EditGroup.HasButtons())
</script> 

<script>
    for (let id of ["01", "02", "02b", "03", "04", "05", "06"]) {
        ShowHTMLinTextArea(document.getElementById("id-js-" + id), document.getElementById("show-js-" + id))} 
</script>


<script>
    //============================================
    // functions to be modified by user
    //============================================

    CONST_EDITABLE_HTML_FUNCTION_CALLS = {
    "edit": editableHTML_your_edit_function,  // innerHTML -> textAreaValue
    "save": editableHTML_your_save_function,  // textAreaValue -> InnerHTML
}

    
    function editableHTML_your_edit_function(innerHTML, editableDiv) {
        // return string that will be the textarea value when edit button is clicked

        return innerHTML
    }

    function editableHTML_your_save_function(textAreaValue, editableDiv) {
        // return string that will be the innerHTML when save button is clicked
        return textAreaValue
    }

    // key events
    document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') editableHTML_DiscardAll()

    if (event.ctrlKey && (event.key === 'Enter' || event.key === ' ')) editableHTML_SaveAllText()
    }); 

</script>

</body>
</html>